# save-job-test-timings action

The `save-job-test-timings` action saves the test timing reports of a single job.

The entry can then be collected, among the ones of the other jobs, by using the `restore-workflow-test-timings` action.

## How does it work

At the end of a split test run, each split job is expected to save its test timing report using the `save-job-test-timings` action. This will save the test timing report file as an artifact of the job, using a special naming pattern.

Then, when all jobs are done, the `save-workflow-test-timings` action can match this pattern, and collect the test timings reports for all jobs of a given workflow.

## Inputs

The action takes two parameters:

- `workflow` (required): the name of the workflow that saved the tests reports.
- `pattern` (optional): the glob pattern of the test timings report, using the JUnit xml file format.

## Usage

The `save-job-test-timings` action must be run once the test run is complete, and the test timings report is generated by your test runner of choice.

```yaml
jobs:
  tests:
    strategy:
      matrix:
        runners: [ 0, 1, 2, 3 ]
    steps:
      - name: 'Run the tests (dummy)'
        run: 'REPORT_FILE=tmp/results_${{ github.job }}_${{ strategy.job-index }}.junit.xml make tests'

      - name: 'Save test timings for job ${{strategy.job-index }}'
        uses: enercoop/split-tests/save-job-test-timings@v1
        with:
          workflow: ${{ github.job }}
          job-index: ${{ strategy.job-index }}
          pattern: 'tmp/*.junit.xml'
```
